{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.207.0"},"children":{"OD-prod-Storage":{"id":"OD-prod-Storage","path":"OD-prod-Storage","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.207.0"},"children":{"Parameters":{"id":"Parameters","path":"OD-prod-Storage/Parameters","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"SenadoBaseUrl":{"id":"SenadoBaseUrl","path":"OD-prod-Storage/Parameters/SenadoBaseUrl","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/SenadoBaseUrl/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Base URL for Senate website","name":"/od/prod/senado/base-url","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"https://www.senado.cl"}}}}},"CamaraBaseUrl":{"id":"CamaraBaseUrl","path":"OD-prod-Storage/Parameters/CamaraBaseUrl","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/CamaraBaseUrl/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Base URL for Chamber of Deputies website","name":"/od/prod/camara/base-url","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"https://www.camara.cl"}}}}},"ServelBaseUrl":{"id":"ServelBaseUrl","path":"OD-prod-Storage/Parameters/ServelBaseUrl","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/ServelBaseUrl/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Base URL for SERVEL website","name":"/od/prod/servel/base-url","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"https://www.servel.cl"}}}}},"ExtractionBatchSize":{"id":"ExtractionBatchSize","path":"OD-prod-Storage/Parameters/ExtractionBatchSize","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/ExtractionBatchSize/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Batch size for data extraction","name":"/od/prod/extraction/batch-size","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"100"}}}}},"ExtractionRetryAttempts":{"id":"ExtractionRetryAttempts","path":"OD-prod-Storage/Parameters/ExtractionRetryAttempts","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/ExtractionRetryAttempts/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Number of retry attempts for failed extractions","name":"/od/prod/extraction/retry-attempts","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"3"}}}}},"ExtractionTimeout":{"id":"ExtractionTimeout","path":"OD-prod-Storage/Parameters/ExtractionTimeout","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/ExtractionTimeout/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Timeout for extraction requests in milliseconds","name":"/od/prod/extraction/timeout","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"30000"}}}}},"AnalyticsThresholds":{"id":"AnalyticsThresholds","path":"OD-prod-Storage/Parameters/AnalyticsThresholds","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/AnalyticsThresholds/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Thresholds for problematic behavior detection","name":"/od/prod/analytics/thresholds","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"{\"excessiveAbsence\":0.2,\"passiveAttendance\":0.3,\"excessiveSpending\":2,\"inconsistentVoting\":0.4}"}}}}},"BedrockModelId":{"id":"BedrockModelId","path":"OD-prod-Storage/Parameters/BedrockModelId","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/BedrockModelId/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Bedrock model ID for AI analysis","name":"/od/prod/ai/bedrock-model-id","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"anthropic.claude-3-5-sonnet-20241022-v2:0"}}}}},"AIAnalysisPrompts":{"id":"AIAnalysisPrompts","path":"OD-prod-Storage/Parameters/AIAnalysisPrompts","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/AIAnalysisPrompts/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"AI prompts for different analysis types","name":"/od/prod/ai/analysis-prompts","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"{\"behaviorAnalyst\":\"Eres un analista especializado en transparencia legislativa chilena.\\nAnaliza los datos proporcionados para identificar comportamientos problemáticos:\\n- Inasistencias injustificadas superiores al promedio\\n- Participación pasiva (asiste pero no vota)\\n- Gastos excesivos comparados con pares\\n- Inconsistencias entre promesas y votaciones\\n\\nProporciona análisis objetivo, basado en datos, con contexto histórico.\\nFormato de respuesta: JSON con campos 'tipo', 'severidad', 'evidencia', 'recomendacion'.\",\"reportGenerator\":\"Eres un periodista especializado en política chilena.\\nGenera reportes mensuales claros y accesibles para ciudadanos sobre:\\n- Resumen ejecutivo del período\\n- Comportamientos destacados (positivos y negativos)\\n- Comparaciones históricas\\n- Impacto en proyectos de ley relevantes\\n\\nUsa lenguaje claro, evita tecnicismos, incluye contexto político relevante.\",\"trendDetector\":\"Eres un analista de datos especializado en tendencias políticas.\\nIdentifica patrones emergentes en datos legislativos:\\n- Cambios en patrones de votación\\n- Tendencias de asistencia por partido\\n- Evolución de gastos parlamentarios\\n- Correlaciones entre eventos políticos y comportamiento\\n\\nProporciona insights predictivos con nivel de confianza.\"}"}}}}},"ApiRateLimits":{"id":"ApiRateLimits","path":"OD-prod-Storage/Parameters/ApiRateLimits","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/ApiRateLimits/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"API rate limits by user type","name":"/od/prod/api/rate-limits","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"{\"free\":{\"requests\":1000,\"period\":\"day\"},\"premium\":{\"requests\":10000,\"period\":\"day\"},\"developer\":{\"requests\":50000,\"period\":\"day\"}}"}}}}},"NotificationSettings":{"id":"NotificationSettings","path":"OD-prod-Storage/Parameters/NotificationSettings","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/NotificationSettings/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Notification system settings","name":"/od/prod/notifications/settings","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"{\"emailFrom\":\"noreply@opendata.cl\",\"webhookTimeout\":5000,\"retryAttempts\":3}"}}}}},"DataRetentionPolicies":{"id":"DataRetentionPolicies","path":"OD-prod-Storage/Parameters/DataRetentionPolicies","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.StringParameter","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/Parameters/DataRetentionPolicies/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ssm.CfnParameter","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SSM::Parameter","aws:cdk:cloudformation:props":{"description":"Data retention policies in days","name":"/od/prod/data/retention-policies","tags":{"Environment":"prod","ManagedBy":"CDK","Project":"OpenDataMotivation"},"type":"String","value":"{\"rawData\":{\"days\":365},\"processedData\":{\"days\":1095},\"analyticsData\":{\"days\":730},\"userSessions\":{\"days\":30}}"}}}}}}},"DataBucket":{"id":"DataBucket","path":"OD-prod-Storage/DataBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/DataBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"accelerateConfiguration":{"accelerationStatus":"Enabled"},"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"open-data-cl-bucket-prod","corsConfiguration":{"corsRules":[{"maxAge":3000,"allowedHeaders":["*"],"allowedMethods":["GET","HEAD"],"allowedOrigins":["*"]}]},"lifecycleConfiguration":{"rules":[{"abortIncompleteMultipartUpload":{"daysAfterInitiation":7},"id":"raw-data-lifecycle","noncurrentVersionExpiration":{"noncurrentDays":90},"noncurrentVersionTransitions":[{"storageClass":"STANDARD_IA","transitionInDays":30}],"prefix":"raw/","status":"Enabled","transitions":[{"storageClass":"STANDARD_IA","transitionInDays":30},{"storageClass":"GLACIER","transitionInDays":90},{"storageClass":"DEEP_ARCHIVE","transitionInDays":365}]},{"abortIncompleteMultipartUpload":{"daysAfterInitiation":7},"id":"processed-data-lifecycle","noncurrentVersionExpiration":{"noncurrentDays":180},"noncurrentVersionTransitions":[{"storageClass":"STANDARD_IA","transitionInDays":30}],"prefix":"processed/","status":"Enabled","transitions":[{"storageClass":"STANDARD_IA","transitionInDays":90},{"storageClass":"GLACIER","transitionInDays":365}]},{"abortIncompleteMultipartUpload":{"daysAfterInitiation":1},"expirationInDays":30,"id":"athena-results-cleanup","prefix":"athena-results/","status":"Enabled"},{"abortIncompleteMultipartUpload":{"daysAfterInitiation":1},"expirationInDays":7,"id":"temp-data-cleanup","prefix":"temp/","status":"Enabled"}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"OD-prod-Storage/DataBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/DataBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"DataBucketE3889A50"},"policyDocument":{"Statement":[{"Action":"s3:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},"/*"]]}]},{"Action":"s3:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},"/*"]]}],"Sid":"DenyInsecureConnections"},{"Action":"s3:PutObject","Condition":{"StringNotEquals":{"s3:x-amz-server-side-encryption":"AES256"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},"/*"]]},"Sid":"DenyUnencryptedObjectUploads"}],"Version":"2012-10-17"}}}}}}}},"S3InitializerFunction":{"id":"S3InitializerFunction","path":"OD-prod-Storage/S3InitializerFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.207.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"OD-prod-Storage/S3InitializerFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"OD-prod-Storage/S3InitializerFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"OD-prod-Storage/S3InitializerFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"OD-prod-Storage/S3InitializerFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/S3InitializerFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:Abort*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"S3InitializerFunctionServiceRoleDefaultPolicyDA8A3984","roles":[{"Ref":"S3InitializerFunctionServiceRole4B8344C9"}]}}}}}}},"Resource":{"id":"Resource","path":"OD-prod-Storage/S3InitializerFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n        const { S3Client, PutObjectCommand } = require('@aws-sdk/client-s3');\n\n        const s3Client = new S3Client({ region: process.env.AWS_REGION });\n\n        exports.handler = async (event) => {\n          console.log('Initializing S3 folder structure', JSON.stringify(event, null, 2));\n\n          const bucketName = process.env.BUCKET_NAME;\n          const folders = [\n            // Raw data structure\n            'raw/senado/legisladores/',\n            'raw/senado/sesiones/',\n            'raw/senado/votaciones/',\n            'raw/senado/proyectos/',\n            'raw/senado/gastos/',\n            'raw/camara/legisladores/',\n            'raw/camara/sesiones/',\n            'raw/camara/votaciones/',\n            'raw/camara/proyectos/',\n            'raw/camara/gastos/',\n            'raw/servel/elecciones/',\n            'raw/servel/candidatos/',\n            'raw/servel/resultados/',\n\n            // Processed data structure\n            'processed/senado/legisladores/',\n            'processed/senado/sesiones/',\n            'processed/senado/votaciones/',\n            'processed/senado/proyectos/',\n            'processed/senado/gastos/',\n            'processed/camara/legisladores/',\n            'processed/camara/sesiones/',\n            'processed/camara/votaciones/',\n            'processed/camara/proyectos/',\n            'processed/camara/gastos/',\n            'processed/servel/elecciones/',\n            'processed/analisis/comportamientos_problematicos/',\n            'processed/analisis/metricas_rendimiento/',\n            'processed/analisis/reportes_ia/',\n\n            // Utility folders\n            'athena-results/',\n            'temp/',\n            'inventory/',\n            'logs/',\n          ];\n\n          try {\n            for (const folder of folders) {\n              const command = new PutObjectCommand({\n                Bucket: bucketName,\n                Key: folder + '.gitkeep',\n                Body: 'This file maintains the folder structure',\n                ContentType: 'text/plain',\n                ServerSideEncryption: 'AES256',\n              });\n\n              await s3Client.send(command);\n              console.log(`Created folder: ${folder}`);\n            }\n\n            return {\n              statusCode: 200,\n              body: JSON.stringify({\n                message: 'S3 folder structure initialized successfully',\n                foldersCreated: folders.length,\n              }),\n            };\n          } catch (error) {\n            console.error('Error initializing S3 structure:', error);\n            throw error;\n          }\n        };\n      "},"environment":{"variables":{"BUCKET_NAME":{"Ref":"DataBucketE3889A50"}}},"functionName":"odm-prod-s3-initializer","handler":"index.handler","loggingConfig":{"logFormat":"JSON"},"memorySize":256,"role":{"Fn::GetAtt":["S3InitializerFunctionServiceRole4B8344C9","Arn"]},"runtime":"nodejs20.x","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"timeout":300}}}}},"S3InitializerProvider":{"id":"S3InitializerProvider","path":"OD-prod-Storage/S3InitializerProvider","constructInfo":{"fqn":"aws-cdk-lib.custom_resources.Provider","version":"2.207.0"},"children":{"framework-onEvent":{"id":"framework-onEvent","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.207.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":[{"Fn::GetAtt":["S3InitializerFunction45CFB7CF","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["S3InitializerFunction45CFB7CF","Arn"]},":*"]]}]},{"Action":"lambda:GetFunction","Effect":"Allow","Resource":{"Fn::GetAtt":["S3InitializerFunction45CFB7CF","Arn"]}}],"Version":"2012-10-17"},"policyName":"S3InitializerProviderframeworkonEventServiceRoleDefaultPolicy37EC78A2","roles":[{"Ref":"S3InitializerProviderframeworkonEventServiceRole077225C8"}]}}}}}}},"Code":{"id":"Code","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.207.0"},"children":{"Stage":{"id":"Stage","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.207.0"}},"AssetBucket":{"id":"AssetBucket","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.207.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"OD-prod-Storage/S3InitializerProvider/framework-onEvent/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-us-east-1"},"s3Key":"bdc104ed9cab1b5b6421713c8155f0b753380595356f710400609664d3635eca.zip"},"description":"AWS CDK resource provider framework - onEvent (OD-prod-Storage/S3InitializerProvider)","environment":{"variables":{"USER_ON_EVENT_FUNCTION_ARN":{"Fn::GetAtt":["S3InitializerFunction45CFB7CF","Arn"]}}},"handler":"framework.onEvent","loggingConfig":{"logFormat":"JSON","applicationLogLevel":"FATAL"},"role":{"Fn::GetAtt":["S3InitializerProviderframeworkonEventServiceRole077225C8","Arn"]},"runtime":"nodejs22.x","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"timeout":900}}}}}}},"S3InitializerResource":{"id":"S3InitializerResource","path":"OD-prod-Storage/S3InitializerResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.207.0","metadata":[]},"children":{"Default":{"id":"Default","path":"OD-prod-Storage/S3InitializerResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"LegislatorsTable":{"id":"LegislatorsTable","path":"OD-prod-Storage/LegislatorsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/LegislatorsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"chamber","attributeType":"S"},{"attributeName":"region","attributeType":"S"},{"attributeName":"party","attributeType":"S"},{"attributeName":"status","attributeType":"S"},{"attributeName":"period","attributeType":"S"},{"attributeName":"performanceScore","attributeType":"N"}],"billingMode":"PAY_PER_REQUEST","contributorInsightsSpecification":{"enabled":true},"deletionProtectionEnabled":true,"globalSecondaryIndexes":[{"indexName":"ChamberRegionIndex","keySchema":[{"attributeName":"chamber","keyType":"HASH"},{"attributeName":"region","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"PartyIndex","keySchema":[{"attributeName":"party","keyType":"HASH"},{"attributeName":"chamber","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"StatusPeriodIndex","keySchema":[{"attributeName":"status","keyType":"HASH"},{"attributeName":"period","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"PerformanceIndex","keySchema":[{"attributeName":"chamber","keyType":"HASH"},{"attributeName":"performanceScore","keyType":"RANGE"}],"projection":{"projectionType":"INCLUDE","nonKeyAttributes":["name","party","region","lastUpdated"]}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"sseSpecification":{"sseEnabled":true},"tableClass":"STANDARD","tableName":"OD-prod-Legislators","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"ScalingRole":{"id":"ScalingRole","path":"OD-prod-Storage/LegislatorsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}}}},"SessionsTable":{"id":"SessionsTable","path":"OD-prod-Storage/SessionsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/SessionsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"date","attributeType":"S"},{"attributeName":"chamber","attributeType":"S"},{"attributeName":"sessionType","attributeType":"S"},{"attributeName":"period","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","contributorInsightsSpecification":{"enabled":true},"deletionProtectionEnabled":true,"globalSecondaryIndexes":[{"indexName":"DateChamberIndex","keySchema":[{"attributeName":"date","keyType":"HASH"},{"attributeName":"chamber","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"ChamberDateIndex","keySchema":[{"attributeName":"chamber","keyType":"HASH"},{"attributeName":"date","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"TypeDateIndex","keySchema":[{"attributeName":"sessionType","keyType":"HASH"},{"attributeName":"date","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"PeriodIndex","keySchema":[{"attributeName":"period","keyType":"HASH"},{"attributeName":"date","keyType":"RANGE"}],"projection":{"projectionType":"INCLUDE","nonKeyAttributes":["chamber","sessionType","quorum","attendanceCount"]}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"sseSpecification":{"sseEnabled":true},"tableClass":"STANDARD","tableName":"OD-prod-Sessions","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"ScalingRole":{"id":"ScalingRole","path":"OD-prod-Storage/SessionsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}}}},"AnalyticsTable":{"id":"AnalyticsTable","path":"OD-prod-Storage/AnalyticsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/AnalyticsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"analyticsType","attributeType":"S"},{"attributeName":"period","attributeType":"S"},{"attributeName":"legislatorId","attributeType":"S"},{"attributeName":"chamber","attributeType":"S"},{"attributeName":"calculatedAt","attributeType":"S"},{"attributeName":"rankingType","attributeType":"S"},{"attributeName":"score","attributeType":"N"}],"billingMode":"PAY_PER_REQUEST","contributorInsightsSpecification":{"enabled":true},"deletionProtectionEnabled":true,"globalSecondaryIndexes":[{"indexName":"TypePeriodIndex","keySchema":[{"attributeName":"analyticsType","keyType":"HASH"},{"attributeName":"period","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"LegislatorTypeIndex","keySchema":[{"attributeName":"legislatorId","keyType":"HASH"},{"attributeName":"analyticsType","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"ChamberCalculatedIndex","keySchema":[{"attributeName":"chamber","keyType":"HASH"},{"attributeName":"calculatedAt","keyType":"RANGE"}],"projection":{"projectionType":"INCLUDE","nonKeyAttributes":["analyticsType","period","legislatorId","data"]}},{"indexName":"RankingIndex","keySchema":[{"attributeName":"rankingType","keyType":"HASH"},{"attributeName":"score","keyType":"RANGE"}],"projection":{"projectionType":"INCLUDE","nonKeyAttributes":["legislatorId","chamber","period","rank"]}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"sseSpecification":{"sseEnabled":true},"tableClass":"STANDARD","tableName":"OD-prod-Analytics","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"OD-prod-Storage/AnalyticsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}}}},"VotationsTable":{"id":"VotationsTable","path":"OD-prod-Storage/VotationsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/VotationsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"projectId","attributeType":"S"},{"attributeName":"votingDate","attributeType":"S"},{"attributeName":"legislatorId","attributeType":"S"},{"attributeName":"chamber","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","contributorInsightsSpecification":{"enabled":true},"deletionProtectionEnabled":true,"globalSecondaryIndexes":[{"indexName":"ProjectDateIndex","keySchema":[{"attributeName":"projectId","keyType":"HASH"},{"attributeName":"votingDate","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"LegislatorDateIndex","keySchema":[{"attributeName":"legislatorId","keyType":"HASH"},{"attributeName":"votingDate","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"ChamberVotingDateIndex","keySchema":[{"attributeName":"chamber","keyType":"HASH"},{"attributeName":"votingDate","keyType":"RANGE"}],"projection":{"projectionType":"INCLUDE","nonKeyAttributes":["projectId","votingType","result","legislatorId","vote"]}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"sseSpecification":{"sseEnabled":true},"tableClass":"STANDARD","tableName":"OD-prod-Votations","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"ScalingRole":{"id":"ScalingRole","path":"OD-prod-Storage/VotationsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}}}},"ProjectsTable":{"id":"ProjectsTable","path":"OD-prod-Storage/ProjectsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/ProjectsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"status","attributeType":"S"},{"attributeName":"lastUpdated","attributeType":"S"},{"attributeName":"originChamber","attributeType":"S"},{"attributeName":"submissionDate","attributeType":"S"},{"attributeName":"urgency","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","contributorInsightsSpecification":{"enabled":true},"deletionProtectionEnabled":true,"globalSecondaryIndexes":[{"indexName":"StatusDateIndex","keySchema":[{"attributeName":"status","keyType":"HASH"},{"attributeName":"lastUpdated","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"OriginChamberIndex","keySchema":[{"attributeName":"originChamber","keyType":"HASH"},{"attributeName":"submissionDate","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"UrgencyDateIndex","keySchema":[{"attributeName":"urgency","keyType":"HASH"},{"attributeName":"submissionDate","keyType":"RANGE"}],"projection":{"projectionType":"INCLUDE","nonKeyAttributes":["title","status","originChamber","currentStage"]}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"sseSpecification":{"sseEnabled":true},"tableClass":"STANDARD","tableName":"OD-prod-Projects","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"ScalingRole":{"id":"ScalingRole","path":"OD-prod-Storage/ProjectsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}}}},"ExpensesTable":{"id":"ExpensesTable","path":"OD-prod-Storage/ExpensesTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Storage/ExpensesTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"legislatorId","attributeType":"S"},{"attributeName":"expenseDate","attributeType":"S"},{"attributeName":"category","attributeType":"S"},{"attributeName":"chamber","attributeType":"S"},{"attributeName":"amount","attributeType":"N"},{"attributeName":"period","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","contributorInsightsSpecification":{"enabled":true},"deletionProtectionEnabled":true,"globalSecondaryIndexes":[{"indexName":"LegislatorDateIndex","keySchema":[{"attributeName":"legislatorId","keyType":"HASH"},{"attributeName":"expenseDate","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"CategoryDateIndex","keySchema":[{"attributeName":"category","keyType":"HASH"},{"attributeName":"expenseDate","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"ChamberAmountIndex","keySchema":[{"attributeName":"chamber","keyType":"HASH"},{"attributeName":"amount","keyType":"RANGE"}],"projection":{"projectionType":"INCLUDE","nonKeyAttributes":["legislatorId","category","expenseDate","description"]}},{"indexName":"PeriodAmountIndex","keySchema":[{"attributeName":"period","keyType":"HASH"},{"attributeName":"amount","keyType":"RANGE"}],"projection":{"projectionType":"INCLUDE","nonKeyAttributes":["legislatorId","chamber","category"]}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"sseSpecification":{"sseEnabled":true},"tableClass":"STANDARD","tableName":"OD-prod-Expenses","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"ScalingRole":{"id":"ScalingRole","path":"OD-prod-Storage/ExpensesTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}}}},"DataBucketName":{"id":"DataBucketName","path":"OD-prod-Storage/DataBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"LegislatorsTableName":{"id":"LegislatorsTableName","path":"OD-prod-Storage/LegislatorsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"SessionsTableName":{"id":"SessionsTableName","path":"OD-prod-Storage/SessionsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"AnalyticsTableName":{"id":"AnalyticsTableName","path":"OD-prod-Storage/AnalyticsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"VotationsTableName":{"id":"VotationsTableName","path":"OD-prod-Storage/VotationsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"ProjectsTableName":{"id":"ProjectsTableName","path":"OD-prod-Storage/ProjectsTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"ExpensesTableName":{"id":"ExpensesTableName","path":"OD-prod-Storage/ExpensesTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"OD-prod-Storage/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"OD-prod-Storage/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"Exports":{"id":"Exports","path":"OD-prod-Storage/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Fn::GetAtt\":[\"DataBucketE3889A50\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"DataBucketE3889A50\",\"Arn\"]}","path":"OD-prod-Storage/Exports/Output{\"Fn::GetAtt\":[\"DataBucketE3889A50\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Fn::GetAtt\":[\"LegislatorsTableB64B4C2F\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"LegislatorsTableB64B4C2F\",\"Arn\"]}","path":"OD-prod-Storage/Exports/Output{\"Fn::GetAtt\":[\"LegislatorsTableB64B4C2F\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Fn::GetAtt\":[\"SessionsTable7C302024\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"SessionsTable7C302024\",\"Arn\"]}","path":"OD-prod-Storage/Exports/Output{\"Fn::GetAtt\":[\"SessionsTable7C302024\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Fn::GetAtt\":[\"AnalyticsTable3F84C304\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"AnalyticsTable3F84C304\",\"Arn\"]}","path":"OD-prod-Storage/Exports/Output{\"Fn::GetAtt\":[\"AnalyticsTable3F84C304\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Fn::GetAtt\":[\"VotationsTable0ADA7A3E\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"VotationsTable0ADA7A3E\",\"Arn\"]}","path":"OD-prod-Storage/Exports/Output{\"Fn::GetAtt\":[\"VotationsTable0ADA7A3E\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Fn::GetAtt\":[\"ProjectsTableAA0A2089\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"ProjectsTableAA0A2089\",\"Arn\"]}","path":"OD-prod-Storage/Exports/Output{\"Fn::GetAtt\":[\"ProjectsTableAA0A2089\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Fn::GetAtt\":[\"ExpensesTableD91D50C8\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"ExpensesTableD91D50C8\",\"Arn\"]}","path":"OD-prod-Storage/Exports/Output{\"Fn::GetAtt\":[\"ExpensesTableD91D50C8\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Ref\":\"DataBucketE3889A50\"}":{"id":"Output{\"Ref\":\"DataBucketE3889A50\"}","path":"OD-prod-Storage/Exports/Output{\"Ref\":\"DataBucketE3889A50\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Ref\":\"LegislatorsTableB64B4C2F\"}":{"id":"Output{\"Ref\":\"LegislatorsTableB64B4C2F\"}","path":"OD-prod-Storage/Exports/Output{\"Ref\":\"LegislatorsTableB64B4C2F\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Ref\":\"SessionsTable7C302024\"}":{"id":"Output{\"Ref\":\"SessionsTable7C302024\"}","path":"OD-prod-Storage/Exports/Output{\"Ref\":\"SessionsTable7C302024\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Ref\":\"AnalyticsTable3F84C304\"}":{"id":"Output{\"Ref\":\"AnalyticsTable3F84C304\"}","path":"OD-prod-Storage/Exports/Output{\"Ref\":\"AnalyticsTable3F84C304\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Ref\":\"VotationsTable0ADA7A3E\"}":{"id":"Output{\"Ref\":\"VotationsTable0ADA7A3E\"}","path":"OD-prod-Storage/Exports/Output{\"Ref\":\"VotationsTable0ADA7A3E\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Ref\":\"ProjectsTableAA0A2089\"}":{"id":"Output{\"Ref\":\"ProjectsTableAA0A2089\"}","path":"OD-prod-Storage/Exports/Output{\"Ref\":\"ProjectsTableAA0A2089\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Ref\":\"ExpensesTableD91D50C8\"}":{"id":"Output{\"Ref\":\"ExpensesTableD91D50C8\"}","path":"OD-prod-Storage/Exports/Output{\"Ref\":\"ExpensesTableD91D50C8\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"OD-prod-Storage/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"OD-prod-Storage/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.207.0"}}}},"OD-prod-Processing":{"id":"OD-prod-Processing","path":"OD-prod-Processing","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.207.0"},"children":{"LambdaExecutionRole":{"id":"LambdaExecutionRole","path":"OD-prod-Processing/LambdaExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportLambdaExecutionRole":{"id":"ImportLambdaExecutionRole","path":"OD-prod-Processing/LambdaExecutionRole/ImportLambdaExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"OD-prod-Processing/LambdaExecutionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AWSXRayDaemonWriteAccess"]]}],"policies":[{"policyName":"DataAccess","policyDocument":{"Statement":[{"Action":["s3:DeleteObject","s3:GetObject","s3:ListBucket","s3:PutObject"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttDataBucketE3889A50Arn98F8399F"},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttDataBucketE3889A50Arn98F8399F"},"/*"]]}]},{"Action":["dynamodb:DeleteItem","dynamodb:GetItem","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttAnalyticsTable3F84C304ArnFD90B42F"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttExpensesTableD91D50C8Arn1CEBEA73"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttLegislatorsTableB64B4C2FArn7C089D9E"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttProjectsTableAA0A2089ArnA2260F04"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttSessionsTable7C302024Arn24FF8012"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttVotationsTable0ADA7A3EArnE50C174C"},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttAnalyticsTable3F84C304ArnFD90B42F"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttExpensesTableD91D50C8Arn1CEBEA73"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttLegislatorsTableB64B4C2FArn7C089D9E"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttProjectsTableAA0A2089ArnA2260F04"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttSessionsTable7C302024Arn24FF8012"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttVotationsTable0ADA7A3EArnE50C174C"},"/index/*"]]}]},{"Action":["ssm:GetParameter","ssm:GetParameters","ssm:GetParametersByPath"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:ssm:us-east-1:",{"Ref":"AWS::AccountId"},":parameter/od/prod/*"]]}},{"Action":"bedrock:InvokeModel","Effect":"Allow","Resource":"arn:aws:bedrock:us-east-1::foundation-model/*"}],"Version":"2012-10-17"}}],"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"OD-prod-Processing/LambdaExecutionRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Processing/LambdaExecutionRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"LambdaExecutionRoleDefaultPolicy6D69732F","roles":[{"Ref":"LambdaExecutionRoleD5C26073"}]}}}}}}},"SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter":{"id":"SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","path":"OD-prod-Processing/SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118":{"id":"SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118","path":"OD-prod-Processing/SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"PowertoolsLayer":{"id":"PowertoolsLayer","path":"OD-prod-Processing/PowertoolsLayer","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"DataExtractorFunction":{"id":"DataExtractorFunction","path":"OD-prod-Processing/DataExtractorFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Processing/DataExtractorFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n        exports.handler = async (event) => {\n          console.log('Data extraction placeholder', JSON.stringify(event, null, 2));\n          return { success: true, message: 'Extraction completed' };\n        };\n      "},"environment":{"variables":{"POWERTOOLS_SERVICE_NAME":"data-extractor","POWERTOOLS_METRICS_NAMESPACE":"OD","LOG_LEVEL":"INFO","DATA_BUCKET_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefDataBucketE3889A50250F5285"},"LEGISLATORS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefLegislatorsTableB64B4C2F4EEFB501"},"SESSIONS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefSessionsTable7C3020246E1CCFDD"},"ANALYTICS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefAnalyticsTable3F84C30437863EDE"},"VOTATIONS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefVotationsTable0ADA7A3E0D2281F4"},"PROJECTS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefProjectsTableAA0A2089BD3C4802"},"EXPENSES_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefExpensesTableD91D50C88F55E2CD"}}},"functionName":"od-prod-data-extractor","handler":"index.handler","layers":[{"Ref":"SsmParameterValueawsservicepowertoolstypescriptgenericalllatestC96584B6F00A464EAD1953AFF4B05118Parameter"}],"loggingConfig":{"logFormat":"JSON"},"memorySize":1024,"role":{"Fn::GetAtt":["LambdaExecutionRoleD5C26073","Arn"]},"runtime":"nodejs20.x","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"timeout":900,"tracingConfig":{"mode":"Active"}}}}}},"DataProcessorFunction":{"id":"DataProcessorFunction","path":"OD-prod-Processing/DataProcessorFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Processing/DataProcessorFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n        exports.handler = async (event) => {\n          console.log('Data processing placeholder', JSON.stringify(event, null, 2));\n          return { success: true, message: 'Processing completed' };\n        };\n      "},"environment":{"variables":{"POWERTOOLS_SERVICE_NAME":"data-processor","POWERTOOLS_METRICS_NAMESPACE":"OD","LOG_LEVEL":"INFO","DATA_BUCKET_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefDataBucketE3889A50250F5285"},"LEGISLATORS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefLegislatorsTableB64B4C2F4EEFB501"},"SESSIONS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefSessionsTable7C3020246E1CCFDD"},"ANALYTICS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefAnalyticsTable3F84C30437863EDE"},"VOTATIONS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefVotationsTable0ADA7A3E0D2281F4"},"PROJECTS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefProjectsTableAA0A2089BD3C4802"},"EXPENSES_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefExpensesTableD91D50C88F55E2CD"}}},"functionName":"od-prod-data-processor","handler":"index.handler","layers":[{"Ref":"SsmParameterValueawsservicepowertoolstypescriptgenericalllatestC96584B6F00A464EAD1953AFF4B05118Parameter"}],"loggingConfig":{"logFormat":"JSON"},"memorySize":2048,"role":{"Fn::GetAtt":["LambdaExecutionRoleD5C26073","Arn"]},"runtime":"nodejs20.x","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"timeout":900,"tracingConfig":{"mode":"Active"}}}}}},"ExtractDataTask":{"id":"ExtractDataTask","path":"OD-prod-Processing/ExtractDataTask","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions_tasks.LambdaInvoke","version":"2.207.0"}},"ProcessDataTask":{"id":"ProcessDataTask","path":"OD-prod-Processing/ProcessDataTask","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions_tasks.LambdaInvoke","version":"2.207.0"}},"ExtractionStateMachine":{"id":"ExtractionStateMachine","path":"OD-prod-Processing/ExtractionStateMachine","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.StateMachine","version":"2.207.0","metadata":[]},"children":{"Role":{"id":"Role","path":"OD-prod-Processing/ExtractionStateMachine/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"OD-prod-Processing/ExtractionStateMachine/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"OD-prod-Processing/ExtractionStateMachine/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"states.amazonaws.com"}}],"Version":"2012-10-17"},"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"OD-prod-Processing/ExtractionStateMachine/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Processing/ExtractionStateMachine/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":[{"Fn::GetAtt":["DataExtractorFunctionAF591CFF","Arn"]},{"Fn::GetAtt":["DataProcessorFunctionAD472B9A","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DataExtractorFunctionAF591CFF","Arn"]},":*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["DataProcessorFunctionAD472B9A","Arn"]},":*"]]}]},{"Action":["xray:GetSamplingRules","xray:GetSamplingTargets","xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"ExtractionStateMachineRoleDefaultPolicy7DD46A50","roles":[{"Ref":"ExtractionStateMachineRole5F08D431"}]}}}}}}},"Resource":{"id":"Resource","path":"OD-prod-Processing/ExtractionStateMachine/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.CfnStateMachine","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::StepFunctions::StateMachine","aws:cdk:cloudformation:props":{"definitionString":{"Fn::Join":["",["{\"StartAt\":\"ExtractDataTask\",\"States\":{\"ExtractDataTask\":{\"Next\":\"ProcessDataTask\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"OutputPath\":\"$.Payload\",\"Resource\":\"arn:",{"Ref":"AWS::Partition"},":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",{"Fn::GetAtt":["DataExtractorFunctionAF591CFF","Arn"]},"\",\"Payload.$\":\"$\"}},\"ProcessDataTask\":{\"End\":true,\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$\",\"OutputPath\":\"$.Payload\",\"Resource\":\"arn:",{"Ref":"AWS::Partition"},":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",{"Fn::GetAtt":["DataProcessorFunctionAD472B9A","Arn"]},"\",\"Payload.$\":\"$\"}}},\"TimeoutSeconds\":7200}"]]},"roleArn":{"Fn::GetAtt":["ExtractionStateMachineRole5F08D431","Arn"]},"stateMachineName":"OD-prod-DataExtraction","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"tracingConfiguration":{"enabled":true}}}},"EventsRole":{"id":"EventsRole","path":"OD-prod-Processing/ExtractionStateMachine/EventsRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportEventsRole":{"id":"ImportEventsRole","path":"OD-prod-Processing/ExtractionStateMachine/EventsRole/ImportEventsRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"OD-prod-Processing/ExtractionStateMachine/EventsRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"events.amazonaws.com"}}],"Version":"2012-10-17"},"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"OD-prod-Processing/ExtractionStateMachine/EventsRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Processing/ExtractionStateMachine/EventsRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"states:StartExecution","Effect":"Allow","Resource":{"Ref":"ExtractionStateMachineEC59ACBD"}}],"Version":"2012-10-17"},"policyName":"ExtractionStateMachineEventsRoleDefaultPolicy59F55A4D","roles":[{"Ref":"ExtractionStateMachineEventsRole23364B01"}]}}}}}}}}},"DailyExtractionRule":{"id":"DailyExtractionRule","path":"OD-prod-Processing/DailyExtractionRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Processing/DailyExtractionRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Trigger daily data extraction","name":"OD-prod-DailyExtraction","scheduleExpression":"cron(0 6 * * ? *)","state":"ENABLED","targets":[{"id":"Target0","arn":{"Ref":"ExtractionStateMachineEC59ACBD"},"roleArn":{"Fn::GetAtt":["ExtractionStateMachineEventsRole23364B01","Arn"]},"input":"{\"extractionType\":\"daily\",\"sources\":[\"senado\",\"camara\"]}"}]}}}}},"WeeklyExtractionRule":{"id":"WeeklyExtractionRule","path":"OD-prod-Processing/WeeklyExtractionRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Processing/WeeklyExtractionRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Trigger weekly SERVEL data extraction","name":"OD-prod-WeeklyExtraction","scheduleExpression":"cron(0 7 ? * SUN *)","state":"ENABLED","targets":[{"id":"Target0","arn":{"Ref":"ExtractionStateMachineEC59ACBD"},"roleArn":{"Fn::GetAtt":["ExtractionStateMachineEventsRole23364B01","Arn"]},"input":"{\"extractionType\":\"weekly\",\"sources\":[\"servel\"]}"}]}}}}},"ExtractionStateMachineArn":{"id":"ExtractionStateMachineArn","path":"OD-prod-Processing/ExtractionStateMachineArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"DataExtractorFunctionArn":{"id":"DataExtractorFunctionArn","path":"OD-prod-Processing/DataExtractorFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"OD-prod-Processing/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"OD-prod-Processing/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"OD-prod-Processing/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"OD-prod-Processing/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.207.0"}}}},"OD-prod-API":{"id":"OD-prod-API","path":"OD-prod-API","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.207.0"},"children":{"ApiLambdaRole":{"id":"ApiLambdaRole","path":"OD-prod-API/ApiLambdaRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportApiLambdaRole":{"id":"ImportApiLambdaRole","path":"OD-prod-API/ApiLambdaRole/ImportApiLambdaRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"OD-prod-API/ApiLambdaRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AWSXRayDaemonWriteAccess"]]}],"policies":[{"policyName":"DataAccess","policyDocument":{"Statement":[{"Action":["s3:GetObject","s3:ListBucket"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttDataBucketE3889A50Arn98F8399F"},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttDataBucketE3889A50Arn98F8399F"},"/*"]]}]},{"Action":["dynamodb:GetItem","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttAnalyticsTable3F84C304ArnFD90B42F"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttExpensesTableD91D50C8Arn1CEBEA73"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttLegislatorsTableB64B4C2FArn7C089D9E"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttProjectsTableAA0A2089ArnA2260F04"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttSessionsTable7C302024Arn24FF8012"},{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttVotationsTable0ADA7A3EArnE50C174C"},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttAnalyticsTable3F84C304ArnFD90B42F"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttExpensesTableD91D50C8Arn1CEBEA73"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttLegislatorsTableB64B4C2FArn7C089D9E"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttProjectsTableAA0A2089ArnA2260F04"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttSessionsTable7C302024Arn24FF8012"},"/index/*"]]},{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputFnGetAttVotationsTable0ADA7A3EArnE50C174C"},"/index/*"]]}]},{"Action":["ssm:GetParameter","ssm:GetParameters"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:ssm:us-east-1:",{"Ref":"AWS::AccountId"},":parameter/od/prod/*"]]}}],"Version":"2012-10-17"}}],"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"OD-prod-API/ApiLambdaRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ApiLambdaRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"ApiLambdaRoleDefaultPolicy84E47AF4","roles":[{"Ref":"ApiLambdaRole66D0B4CD"}]}}}}}}},"SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter":{"id":"SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","path":"OD-prod-API/SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118":{"id":"SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118","path":"OD-prod-API/SsmParameterValue:--aws--service--powertools--typescript--generic--all--latest:C96584B6-F00A-464E-AD19-53AFF4B05118","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"PowertoolsLayer":{"id":"PowertoolsLayer","path":"OD-prod-API/PowertoolsLayer","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"LegislatorsHandler":{"id":"LegislatorsHandler","path":"OD-prod-API/LegislatorsHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/LegislatorsHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n        exports.handler = async (event) => {\n          console.log('Legislators API placeholder', JSON.stringify(event, null, 2));\n          return {\n            success: true,\n            data: {\n              legislators: [],\n              total: 0,\n              page: 1\n            }\n          };\n        };\n      "},"environment":{"variables":{"POWERTOOLS_SERVICE_NAME":"legislators-api","POWERTOOLS_METRICS_NAMESPACE":"OD","LOG_LEVEL":"INFO","DATA_BUCKET_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefDataBucketE3889A50250F5285"},"LEGISLATORS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefLegislatorsTableB64B4C2F4EEFB501"},"SESSIONS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefSessionsTable7C3020246E1CCFDD"},"ANALYTICS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefAnalyticsTable3F84C30437863EDE"},"VOTATIONS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefVotationsTable0ADA7A3E0D2281F4"},"PROJECTS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefProjectsTableAA0A2089BD3C4802"},"EXPENSES_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefExpensesTableD91D50C88F55E2CD"}}},"functionName":"od-prod-legislators-api","handler":"index.handler","layers":[{"Ref":"SsmParameterValueawsservicepowertoolstypescriptgenericalllatestC96584B6F00A464EAD1953AFF4B05118Parameter"}],"loggingConfig":{"logFormat":"JSON"},"memorySize":512,"role":{"Fn::GetAtt":["ApiLambdaRole66D0B4CD","Arn"]},"runtime":"nodejs20.x","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"timeout":30,"tracingConfig":{"mode":"Active"}}}}}},"AnalyticsHandler":{"id":"AnalyticsHandler","path":"OD-prod-API/AnalyticsHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/AnalyticsHandler/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n        exports.handler = async (event) => {\n          console.log('Analytics API placeholder', JSON.stringify(event, null, 2));\n          return {\n            success: true,\n            data: {\n              rankings: [],\n              metrics: {}\n            }\n          };\n        };\n      "},"environment":{"variables":{"POWERTOOLS_SERVICE_NAME":"analytics-api","POWERTOOLS_METRICS_NAMESPACE":"OD","LOG_LEVEL":"INFO","DATA_BUCKET_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefDataBucketE3889A50250F5285"},"LEGISLATORS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefLegislatorsTableB64B4C2F4EEFB501"},"SESSIONS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefSessionsTable7C3020246E1CCFDD"},"ANALYTICS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefAnalyticsTable3F84C30437863EDE"},"VOTATIONS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefVotationsTable0ADA7A3E0D2281F4"},"PROJECTS_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefProjectsTableAA0A2089BD3C4802"},"EXPENSES_TABLE_NAME":{"Fn::ImportValue":"OD-prod-Storage:ExportsOutputRefExpensesTableD91D50C88F55E2CD"}}},"functionName":"od-prod-analytics-api","handler":"index.handler","layers":[{"Ref":"SsmParameterValueawsservicepowertoolstypescriptgenericalllatestC96584B6F00A464EAD1953AFF4B05118Parameter"}],"loggingConfig":{"logFormat":"JSON"},"memorySize":512,"role":{"Fn::GetAtt":["ApiLambdaRole66D0B4CD","Arn"]},"runtime":"nodejs20.x","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"timeout":30,"tracingConfig":{"mode":"Active"}}}}}},"ODApi":{"id":"ODApi","path":"OD-prod-API/ODApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"Open Data API","name":"OD-prod-API","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"CloudWatchRole":{"id":"CloudWatchRole","path":"OD-prod-API/ODApi/CloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"OD-prod-API/ODApi/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/CloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}],"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}}}},"Account":{"id":"Account","path":"OD-prod-API/ODApi/Account","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["ODApiCloudWatchRole94AF041E","Arn"]}}}},"Deployment":{"id":"Deployment","path":"OD-prod-API/ODApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"Open Data API","restApiId":{"Ref":"ODApi07BAFD8A"}}}}}},"DeploymentStage.prod":{"id":"DeploymentStage.prod","path":"OD-prod-API/ODApi/DeploymentStage.prod","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/DeploymentStage.prod/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"ODApiDeploymentB16D4BFB721957e0c9d57d272d1694ee75d910fa"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":true,"loggingLevel":"INFO","metricsEnabled":true}],"restApiId":{"Ref":"ODApi07BAFD8A"},"stageName":"prod","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"tracingEnabled":true}}}}},"Endpoint":{"id":"Endpoint","path":"OD-prod-API/ODApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Default":{"id":"Default","path":"OD-prod-API/ODApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.207.0","metadata":[]},"children":{"OPTIONS":{"id":"OPTIONS","path":"OD-prod-API/ODApi/Default/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Fn::GetAtt":["ODApi07BAFD8A","RootResourceId"]},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}},"api":{"id":"api","path":"OD-prod-API/ODApi/Default/api","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["ODApi07BAFD8A","RootResourceId"]},"pathPart":"api","restApiId":{"Ref":"ODApi07BAFD8A"}}}},"OPTIONS":{"id":"OPTIONS","path":"OD-prod-API/ODApi/Default/api/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Ref":"ODApiapiB7532920"},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}},"v1":{"id":"v1","path":"OD-prod-API/ODApi/Default/api/v1","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Ref":"ODApiapiB7532920"},"pathPart":"v1","restApiId":{"Ref":"ODApi07BAFD8A"}}}},"OPTIONS":{"id":"OPTIONS","path":"OD-prod-API/ODApi/Default/api/v1/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Ref":"ODApiapiv160156A20"},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}},"legislators":{"id":"legislators","path":"OD-prod-API/ODApi/Default/api/v1/legislators","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/legislators/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Ref":"ODApiapiv160156A20"},"pathPart":"legislators","restApiId":{"Ref":"ODApi07BAFD8A"}}}},"OPTIONS":{"id":"OPTIONS","path":"OD-prod-API/ODApi/Default/api/v1/legislators/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/legislators/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Ref":"ODApiapiv1legislatorsAA4596CE"},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}},"GET":{"id":"GET","path":"OD-prod-API/ODApi/Default/api/v1/legislators/GET","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"ApiPermission.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators":{"id":"ApiPermission.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators","path":"OD-prod-API/ODApi/Default/api/v1/legislators/GET/ApiPermission.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["LegislatorsHandler39F9CA0E","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:",{"Ref":"AWS::AccountId"},":",{"Ref":"ODApi07BAFD8A"},"/",{"Ref":"ODApiDeploymentStageprod80AB9DC2"},"/GET/api/v1/legislators"]]}}}},"ApiPermission.Test.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators":{"id":"ApiPermission.Test.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators","path":"OD-prod-API/ODApi/Default/api/v1/legislators/GET/ApiPermission.Test.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["LegislatorsHandler39F9CA0E","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:",{"Ref":"AWS::AccountId"},":",{"Ref":"ODApi07BAFD8A"},"/test-invoke-stage/GET/api/v1/legislators"]]}}}},"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/legislators/GET/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"GET","integration":{"type":"AWS","uri":{"Fn::Join":["",["arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["LegislatorsHandler39F9CA0E","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST","requestTemplates":{"application/json":"{\"action\":\"list\",\"page\":\"$input.params('page')\",\"limit\":\"$input.params('limit')\",\"chamber\":\"$input.params('chamber')\",\"region\":\"$input.params('region')\"}"},"integrationResponses":[{"statusCode":"200","responseTemplates":{"application/json":"$input.path('$.data')"}},{"statusCode":"400","selectionPattern":".*\"success\":false.*","responseTemplates":{"application/json":"{\"error\": \"$input.path('$.error')\"}"}}]},"methodResponses":[{"statusCode":"200"},{"statusCode":"400"}],"resourceId":{"Ref":"ODApiapiv1legislatorsAA4596CE"},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}},"{id}":{"id":"{id}","path":"OD-prod-API/ODApi/Default/api/v1/legislators/{id}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/legislators/{id}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Ref":"ODApiapiv1legislatorsAA4596CE"},"pathPart":"{id}","restApiId":{"Ref":"ODApi07BAFD8A"}}}},"OPTIONS":{"id":"OPTIONS","path":"OD-prod-API/ODApi/Default/api/v1/legislators/{id}/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/legislators/{id}/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Ref":"ODApiapiv1legislatorsid588E72DC"},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}},"GET":{"id":"GET","path":"OD-prod-API/ODApi/Default/api/v1/legislators/{id}/GET","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"ApiPermission.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators.{id}":{"id":"ApiPermission.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators.{id}","path":"OD-prod-API/ODApi/Default/api/v1/legislators/{id}/GET/ApiPermission.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators.{id}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["LegislatorsHandler39F9CA0E","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:",{"Ref":"AWS::AccountId"},":",{"Ref":"ODApi07BAFD8A"},"/",{"Ref":"ODApiDeploymentStageprod80AB9DC2"},"/GET/api/v1/legislators/*"]]}}}},"ApiPermission.Test.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators.{id}":{"id":"ApiPermission.Test.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators.{id}","path":"OD-prod-API/ODApi/Default/api/v1/legislators/{id}/GET/ApiPermission.Test.ODprodAPIODApi30CDDB1A.GET..api.v1.legislators.{id}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["LegislatorsHandler39F9CA0E","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:",{"Ref":"AWS::AccountId"},":",{"Ref":"ODApi07BAFD8A"},"/test-invoke-stage/GET/api/v1/legislators/*"]]}}}},"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/legislators/{id}/GET/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"GET","integration":{"type":"AWS","uri":{"Fn::Join":["",["arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["LegislatorsHandler39F9CA0E","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST","requestTemplates":{"application/json":"{\"action\":\"get\",\"legislatorId\":\"$input.params('id')\"}"},"integrationResponses":[{"statusCode":"200","responseTemplates":{"application/json":"$input.path('$.data')"}},{"statusCode":"404","selectionPattern":".*\"success\":false.*","responseTemplates":{"application/json":"{\"error\": \"$input.path('$.error')\"}"}}]},"methodResponses":[{"statusCode":"200"},{"statusCode":"404"}],"resourceId":{"Ref":"ODApiapiv1legislatorsid588E72DC"},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}}}}}},"analytics":{"id":"analytics","path":"OD-prod-API/ODApi/Default/api/v1/analytics","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/analytics/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Ref":"ODApiapiv160156A20"},"pathPart":"analytics","restApiId":{"Ref":"ODApi07BAFD8A"}}}},"OPTIONS":{"id":"OPTIONS","path":"OD-prod-API/ODApi/Default/api/v1/analytics/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/analytics/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Ref":"ODApiapiv1analytics91197F58"},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}},"rankings":{"id":"rankings","path":"OD-prod-API/ODApi/Default/api/v1/analytics/rankings","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/analytics/rankings/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Ref":"ODApiapiv1analytics91197F58"},"pathPart":"rankings","restApiId":{"Ref":"ODApi07BAFD8A"}}}},"OPTIONS":{"id":"OPTIONS","path":"OD-prod-API/ODApi/Default/api/v1/analytics/rankings/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/analytics/rankings/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,X-Amz-Date,Authorization,X-Api-Key'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Ref":"ODApiapiv1analyticsrankingsDFA426CE"},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}},"GET":{"id":"GET","path":"OD-prod-API/ODApi/Default/api/v1/analytics/rankings/GET","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.207.0","metadata":[]},"children":{"ApiPermission.ODprodAPIODApi30CDDB1A.GET..api.v1.analytics.rankings":{"id":"ApiPermission.ODprodAPIODApi30CDDB1A.GET..api.v1.analytics.rankings","path":"OD-prod-API/ODApi/Default/api/v1/analytics/rankings/GET/ApiPermission.ODprodAPIODApi30CDDB1A.GET..api.v1.analytics.rankings","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["AnalyticsHandlerF43C4325","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:",{"Ref":"AWS::AccountId"},":",{"Ref":"ODApi07BAFD8A"},"/",{"Ref":"ODApiDeploymentStageprod80AB9DC2"},"/GET/api/v1/analytics/rankings"]]}}}},"ApiPermission.Test.ODprodAPIODApi30CDDB1A.GET..api.v1.analytics.rankings":{"id":"ApiPermission.Test.ODprodAPIODApi30CDDB1A.GET..api.v1.analytics.rankings","path":"OD-prod-API/ODApi/Default/api/v1/analytics/rankings/GET/ApiPermission.Test.ODprodAPIODApi30CDDB1A.GET..api.v1.analytics.rankings","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["AnalyticsHandlerF43C4325","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:us-east-1:",{"Ref":"AWS::AccountId"},":",{"Ref":"ODApi07BAFD8A"},"/test-invoke-stage/GET/api/v1/analytics/rankings"]]}}}},"Resource":{"id":"Resource","path":"OD-prod-API/ODApi/Default/api/v1/analytics/rankings/GET/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"GET","integration":{"type":"AWS","uri":{"Fn::Join":["",["arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["AnalyticsHandlerF43C4325","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST","requestTemplates":{"application/json":"{\"action\":\"rankings\",\"type\":\"$input.params('type')\",\"chamber\":\"$input.params('chamber')\",\"period\":\"$input.params('period')\"}"},"integrationResponses":[{"statusCode":"200","responseTemplates":{"application/json":"$input.path('$.data')"}}]},"methodResponses":[{"statusCode":"200"}],"resourceId":{"Ref":"ODApiapiv1analyticsrankingsDFA426CE"},"restApiId":{"Ref":"ODApi07BAFD8A"}}}}}}}}}}}}}}}}}},"ApiGatewayUrl":{"id":"ApiGatewayUrl","path":"OD-prod-API/ApiGatewayUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"ApiGatewayId":{"id":"ApiGatewayId","path":"OD-prod-API/ApiGatewayId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"OD-prod-API/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"OD-prod-API/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"Exports":{"id":"Exports","path":"OD-prod-API/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Ref\":\"ODApi07BAFD8A\"}":{"id":"Output{\"Ref\":\"ODApi07BAFD8A\"}","path":"OD-prod-API/Exports/Output{\"Ref\":\"ODApi07BAFD8A\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"OD-prod-API/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"OD-prod-API/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.207.0"}}}},"OD-prod-Frontend":{"id":"OD-prod-Frontend","path":"OD-prod-Frontend","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.207.0"},"children":{"WebsiteBucket":{"id":"WebsiteBucket","path":"OD-prod-Frontend/WebsiteBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Frontend/WebsiteBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"open-data-website-prod","publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:cr-owned:0ab5552c","value":"true"},{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"Policy":{"id":"Policy","path":"OD-prod-Frontend/WebsiteBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Frontend/WebsiteBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"WebsiteBucket75C24D94"},"policyDocument":{"Statement":[{"Action":"s3:GetObject","Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["WebsiteBucket75C24D94","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"OAI":{"id":"OAI","path":"OD-prod-Frontend/OAI","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.OriginAccessIdentity","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Frontend/OAI/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnCloudFrontOriginAccessIdentity","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::CloudFrontOriginAccessIdentity","aws:cdk:cloudformation:props":{"cloudFrontOriginAccessIdentityConfig":{"comment":"OAI for OD prod website"}}}}}},"Distribution":{"id":"Distribution","path":"OD-prod-Frontend/Distribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.207.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"OD-prod-Frontend/Distribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"Origin2":{"id":"Origin2","path":"OD-prod-Frontend/Distribution/Origin2","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"Resource":{"id":"Resource","path":"OD-prod-Frontend/Distribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::GetAtt":["WebsiteBucket75C24D94","RegionalDomainName"]},"id":"ODprodFrontendDistributionOrigin135373395","s3OriginConfig":{"originAccessIdentity":{"Fn::Join":["",["origin-access-identity/cloudfront/",{"Ref":"OAIE1EFC67F"}]]}}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"OD-prod-API:ExportsOutputRefODApi07BAFD8A0413D835"},".execute-api.us-east-1.amazonaws.com"]]},"id":"ODprodFrontendDistributionOrigin20ED47DC5","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"ODprodFrontendDistributionOrigin135373395","allowedMethods":["GET","HEAD","OPTIONS"],"cachedMethods":["GET","HEAD","OPTIONS"],"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"redirect-to-https"},"cacheBehaviors":[{"pathPattern":"/api/*","targetOriginId":"ODprodFrontendDistributionOrigin20ED47DC5","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"88a5eaf4-2fd4-4709-b370-b4c650ea3fcf","viewerProtocolPolicy":"redirect-to-https"}],"comment":"OD prod website distribution","customErrorResponses":[{"errorCachingMinTtl":300,"errorCode":404,"responseCode":200,"responsePagePath":"/index.html"},{"errorCachingMinTtl":300,"errorCode":403,"responseCode":200,"responsePagePath":"/index.html"}],"defaultRootObject":"index.html","httpVersion":"http2and3","ipv6Enabled":true,"priceClass":"PriceClass_All"},"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}}}},"WebsiteDeployment":{"id":"WebsiteDeployment","path":"OD-prod-Frontend/WebsiteDeployment","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_deployment.BucketDeployment","version":"2.207.0"},"children":{"AwsCliLayer":{"id":"AwsCliLayer","path":"OD-prod-Frontend/WebsiteDeployment/AwsCliLayer","constructInfo":{"fqn":"aws-cdk-lib.lambda_layer_awscli.AwsCliLayer","version":"2.207.0","metadata":[]},"children":{"Code":{"id":"Code","path":"OD-prod-Frontend/WebsiteDeployment/AwsCliLayer/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.207.0"},"children":{"Stage":{"id":"Stage","path":"OD-prod-Frontend/WebsiteDeployment/AwsCliLayer/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.207.0"}},"AssetBucket":{"id":"AssetBucket","path":"OD-prod-Frontend/WebsiteDeployment/AwsCliLayer/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.207.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"OD-prod-Frontend/WebsiteDeployment/AwsCliLayer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnLayerVersion","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::LayerVersion","aws:cdk:cloudformation:props":{"content":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-us-east-1"},"s3Key":"c49d356cac773d491c5f7ac148995a1181498a8e289429f8612a7f7e3814f535.zip"},"description":"/opt/awscli/aws"}}}}},"CustomResourceHandler":{"id":"CustomResourceHandler","path":"OD-prod-Frontend/WebsiteDeployment/CustomResourceHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.SingletonFunction","version":"2.207.0","metadata":[]}},"Asset1":{"id":"Asset1","path":"OD-prod-Frontend/WebsiteDeployment/Asset1","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.207.0"},"children":{"Stage":{"id":"Stage","path":"OD-prod-Frontend/WebsiteDeployment/Asset1/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.207.0"}},"AssetBucket":{"id":"AssetBucket","path":"OD-prod-Frontend/WebsiteDeployment/Asset1/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.207.0","metadata":[]}}}},"CustomResource":{"id":"CustomResource","path":"OD-prod-Frontend/WebsiteDeployment/CustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.207.0","metadata":[]},"children":{"Default":{"id":"Default","path":"OD-prod-Frontend/WebsiteDeployment/CustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}}}},"Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C":{"id":"Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.207.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetBucket*","s3:GetObject*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:aws:s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-us-east-1"},"/*"]]},{"Fn::Join":["",["arn:aws:s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-us-east-1"}]]}]},{"Action":["s3:Abort*","s3:DeleteObject*","s3:GetBucket*","s3:GetObject*","s3:List*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["WebsiteBucket75C24D94","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["WebsiteBucket75C24D94","Arn"]},"/*"]]}]},{"Action":["cloudfront:CreateInvalidation","cloudfront:GetInvalidation"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF","roles":[{"Ref":"CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265"}]}}}}}}},"Code":{"id":"Code","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.207.0"},"children":{"Stage":{"id":"Stage","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.207.0"}},"AssetBucket":{"id":"AssetBucket","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.207.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"OD-prod-Frontend/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-us-east-1"},"s3Key":"9a1fcb4a7ecba81ad70e9d3fb241f6794497da945dae5f25924e4dd002b65f2d.zip"},"environment":{"variables":{"AWS_CA_BUNDLE":"/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem"}},"handler":"index.handler","layers":[{"Ref":"WebsiteDeploymentAwsCliLayer5BFD2264"}],"role":{"Fn::GetAtt":["CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265","Arn"]},"runtime":"python3.11","tags":[{"key":"Environment","value":"prod"},{"key":"ManagedBy","value":"CDK"},{"key":"Project","value":"OpenDataMotivation"}],"timeout":900}}}}},"WebsiteUrl":{"id":"WebsiteUrl","path":"OD-prod-Frontend/WebsiteUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"WebsiteBucketName":{"id":"WebsiteBucketName","path":"OD-prod-Frontend/WebsiteBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"DistributionId":{"id":"DistributionId","path":"OD-prod-Frontend/DistributionId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"OD-prod-Frontend/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"OD-prod-Frontend/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"OD-prod-Frontend/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"OD-prod-Frontend/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.207.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}